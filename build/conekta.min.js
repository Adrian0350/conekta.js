!function(){var a,b,c,d,e;!jQuery.support.cors&&jQuery.ajaxTransport&&window.XDomainRequest&&(b=/^https?:\/\//i,a=/^get|post|put|delete$/i,d=new RegExp("^"+location.protocol,"i"),c=/\/json/i,e=/\/xml/i,jQuery.ajaxTransport("text html xml json",function(f,g){var h,i;return location.protocol.match(/^http:$/)&&(f.url=f.url.replace(/^https/,"http")),f.crossDomain&&f.async&&a.test(f.type)&&b.test(f.url)&&d.test(f.url)?(i=null,h=(g.dataType||"").toLowerCase(),{send:function(a,b){var d,j,k,l,m;return i=new XDomainRequest,/^\d+$/.test(g.timeout)&&(i.timeout=g.timeout),i.ontimeout=function(){return b(500,"timeout")},i.onload=function(){var a,d,f,g,j,k;a="Content-Length: "+i.responseText.length+"\r\nContent-Type: "+i.contentType,k={code:200,message:"success"},j={text:i.responseText};try{if("json"===h||"text"!==h&&c.test(i.contentType))try{return j.json=jQuery.parseJSON(i.responseText)}catch(l){return f=l,k.code=500,k.message="parseerror"}else if("xml"===h||"text"!==h&&e.test(i.contentType)){d=new ActiveXObject("Microsoft.XMLDOM"),d.async=!1;try{d.loadXML(i.responseText)}catch(l){f=l,d=void 0}if(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)throw k.code=500,k.message="parseerror","Invalid XML: "+i.responseText;return j.xml=d}}catch(l){throw g=l}finally{b(k.code,k.message,j,a)}},i.onprogress=function(){},i.onerror=function(){return b(500,"error",{text:i.responseText})},"put"===f.type.toLowerCase()&&(f.type="post",k=f.url.lastIndexOf("/"),k>0&&(j=f.url.substring(0,k+1),l=f.url.substring(k+1,f.url.length-1),f.url=j+"update/"+l)),"delete"===f.type.toLowerCase()&&(f.type="post",k=f.url.lastIndexOf("/"),k>0&&(j=f.url.substring(0,k+1),l=f.url.substring(k+1,f.url.length-1),f.url=j+"destroy/"+l)),f.url=f.url.replace(/paymentsapi-dev\.herokuapp\.com\//,"paymentsapi-dev.herokuapp.com/v1/"),f.headers.Authorization&&(f.url=f.url.match(/\?/)?f.url+"&auth_token="+f.headers.Authorization.replace(/Token token\=\"/,"").replace(/"/,""):f.url+"?auth_token="+f.headers.Authorization.replace(/Token token\=\"/,"").replace(/"/,"")),d=g.data,"string"==typeof g.data&&(d=JSON.parse(g.data)),m=g.data&&jQuery.param(d)||"",i.open(f.type,f.url),i.send(m)},abort:function(){return i?i.abort():void 0}}):void 0}))}.call(this),function(){var a;a=null,window.conekta={_helpers:{x_domain_post:function(a){var b,c;return c="POST",b="JSON",navigator.userAgent.match(/MSIE [67]+/)&&(b="JSONP",c="GET"),jQuery.ajax({url:"https://paymentsapi-dev.herokuapp.com/"+a.url+".json",type:c,dataType:b,data:a.data,headers:{Authorization:'Token token="'+conekta.getPublishableToken()+'"'},success:function(b){return a.success(b)},error:function(b){return a.error(JSON.parse(b.responseText||"{}"))}})},log:function(a){return console&&console.log?console.log(a):void 0}}},conekta.setPublishableToken=function(b){"string"==typeof b&&b.match(/^[a-zA-Z0-9]*$/)&&b.length>=20&&b.length<30?a=b:conekta._helpers.log("Unusable public token: "+b)},conekta.getPublishableToken=function(){return a}}.call(this),function(){conekta.charge={},conekta.charge.preauthorizePayment=function(a,b,c){return"function"!=typeof b&&(b=conekta._helpers.log),"function"!=typeof c&&(c=conekta._helpers.log),"object"==typeof a?conekta._helpers.x_domain_post({url:"/charges",data:a,success:function(a){var c;return a&&a.card&&a.card.redirect_form?(c=jQuery("<form></form>"),c.attr("style","display:none;"),c.attr("action",a.redirect_form.url),c.attr("method",a.redirect_form.action),jQuery.each(a.redirect_form.attributes,function(a,b){return c.append(jQuery("<input/>").attr("type","hidden").attr("name",b).val(a))}),jQuery("body").append(c),c.submit(),c.remove()):b(a)},error:c}):c({type:"invalid_request_error",message:"Supplied parameter 'charge' is not a javascript object"})}}.call(this),function(){var a,b,c,d,e,f=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};b=[{name:"amex",pattern:/^3[47]/,valid_length:[15]},{name:"diners_club_carte_blanche",pattern:/^30[0-5]/,valid_length:[14]},{name:"diners_club_international",pattern:/^36/,valid_length:[14]},{name:"jcb",pattern:/^35(2[89]|[3-8][0-9])/,valid_length:[16]},{name:"laser",pattern:/^(6304|670[69]|6771)/,valid_length:[16,17,18,19]},{name:"visa_electron",pattern:/^(4026|417500|4508|4844|491(3|7))/,valid_length:[16]},{name:"visa",pattern:/^4/,valid_length:[16]},{name:"mastercard",pattern:/^5[1-5]/,valid_length:[16]},{name:"maestro",pattern:/^(5018|5020|5038|6304|6759|676[1-3])/,valid_length:[12,13,14,15,16,17,18,19]},{name:"discover",pattern:/^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)/,valid_length:[16]}],e=function(a){var b,c,d,e,f,g;for(d=0,g=a.split("").reverse(),c=e=0,f=g.length;f>e;c=++e)b=g[c],b=+b,c%2?(b*=2,d+=10>b?b:b-9):d+=b;return 0===d%10},d=function(a,b){var c;return c=a.length,f.call(b.valid_length,c)>=0},a=["visa","mastercard"],c=function(c){var d,e,g,h,i;for(i=function(){var c,e,g,h;for(h=[],c=0,e=b.length;e>c;c++)d=b[c],g=d.name,f.call(a,g)>=0&&h.push(d);return h}(),g=0,h=i.length;h>g;g++)if(e=i[g],c.match(e.pattern))return e;return null},conekta.card={},conekta.card.getBrand=function(a){var b;return"string"==typeof a?a=a.replace(/[ -]/g,""):"number"==typeof a&&(a=toString(a)),b=c(a),b&&b.name?b.name:null},conekta.card.validateCVC=function(a){return"number"==typeof a&&a>=0&&1e4>a||"string"==typeof a&&a.match(/^[\d]{3,4}$/)?!0:!1},conekta.card.validateExpiry=function(a,b){return"string"==typeof a&&a.match(/^[\d]{1,2}$/)&&(a=parseInt(a)),b.match(/^([\d]{2,2}|20[\d]{2,2})$/)&&("string"==typeof b&&b.match(/^([\d]{2,2})$/)&&(b="20"+b),b=parseInt(b)),"number"==typeof a&&a>0&&13>a&&"number"==typeof b&&b>2012&&2050>b?Date.parse(a+"/"+new Date(b,a,0).getDate()+"/"+b)>Date.now():!1},conekta.card.validateNumber=function(a){var b,f,g;return"string"==typeof a?a=a.replace(/[ -]/g,""):type("number"===a)&&(a=toString(a)),b=c(a),g=!1,f=!1,null!=b&&(g=e(a),f=d(a,b)),g&&f}}.call(this);